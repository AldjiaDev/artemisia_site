<!DOCTYPE html>
<html>
  <head>
    <title>Artemisia Gentileschi</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">

    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous">

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
      integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2Pk8V+JZbUq5VdS+GpGkS2Gd9Gq0PpnQdQmB8N9IhFj7V75R8l+7kMl+4g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer" />

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body>

    <%= yield %>

    <!-- Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous">
    </script>

    <!-- Overlay pour l'effet page flip -->
    <div id="page-flip-overlay" class="page-flip d-none"></div>

    <!-- Script pour l'effet page flip -->
    <script>
      function initPageFlip() {
        const triggers = document.querySelectorAll(".page-flip-trigger");
        const overlay  = document.getElementById("page-flip-overlay");

        if (!overlay || triggers.length === 0) return;

        triggers.forEach(trigger => {
          trigger.addEventListener("click", (e) => {
            e.preventDefault();
            const targetUrl = trigger.getAttribute("href");

            overlay.classList.remove("d-none");
            overlay.classList.add("animate");

            setTimeout(() => {
              window.location.href = targetUrl;
            }, 900);
          });
        });
      }

      // Rails 7 + Turbo
      document.addEventListener("turbo:load", initPageFlip);

      // Fallback
      document.addEventListener("DOMContentLoaded", initPageFlip);
    </script>

  </body>
</html>

